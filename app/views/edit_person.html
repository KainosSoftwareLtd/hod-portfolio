{% extends "layout.html" %}

{% block pageTitle %}
Edit team members
{% endblock %}

{% block content %}

<main id="content" role="main">

    <div class="grid-row">
        <section style="padding-top:30px;">

            <h1 class="form-title heading-large">
                Edit Person
            </h1>

            <form action="#" class="form" id="person-form">
                <div class="grid-row">
                    <input type="hidden" class="form-control" id="personId" name="person[id]" value="{{ person.id }}">
                    <section>
                        <div class="form-group">
                            <label class="form-label-bold" for="name">Name</label>
                            <p class="form-hint">Person name</p>
                            <input type="text" class="form-control" id="name" name="person[name]" value="{{ person.name }}">
                        </div>

                        <div class="form-group">
                            <label class="form-label-bold" for="role">Role</label>
                            <p class="form-hint">Person role</p>
                            <input type="text" class="form-control" id="role" name="person[role]" value="{{ person.role }}">
                        </div>
                        <div class="form-group">
                            <label class="form-label-bold" for="email">Email</label>
                            <p class="form-hint">Person email</p>
                            <input type="email" class="form-control" id="email" name="person[email]" value="{{ person.email }}">
                        </div>

                        <div class="form-group">
                            <label class="form-label-bold" for="mobile">Mobile</label>
                            <p class="form-hint">Person mobile</p>
                            <input type="text" class="form-control" id="mobile" name="person[mobile]" value="{{ person.mobile }}">
                        </div>

                        <div class="form-group">
                            <label class="form-label-bold" for="slack">Slack</label>
                            <p class="form-hint">Person slack ID</p>
                            <input type="text" class="form-control" id="slack" name="person[slack]" value="{{ person.slack }}">
                        </div>

                        <div class="form-group">
                            <label class="form-label-bold" for="skype">Skype</label>
                            <p class="form-hint">Person Skype ID</p>
                            <input type="text" class="form-control" id="skype" name="person[skype]" value="{{ person.skype }}">
                        </div>
                    </section>
                </div>

                <div class="form-group">
                    <input type="submit" class="button" value="Submit">
                </div>
            </form>
        </section>
    </div>
</main>
{% endblock %}

{% block body_end %}
{{ super() }}
<script>
    $("#person-form").submit(function(e) {
        e.preventDefault();

        var data = $('#person-form').serializeObject();

        $.ajax({
            type: "PUT",
            url: '/api/projects/{{ projectId }}/person/team/' + data.person.id,
            contentType: "application/json",
            data: JSON.stringify(data)

        })
        .done(function(response) {
            alert(JSON.stringify(response.messages[0]));
            window.location.href = '/projects/{{ projectId }}/edit-our-team';
        })
        .fail(function(jqXHR, textStatus) {
            alert('There was an error while updating person. ' + jqXHR.responseText);
        });
    });

</script>
{% endblock %}
