{% extends "layout.html" %} {% block content %}
<main id="content" role="main">
  <div class="grid-row">
    <h1 class="heading-xlarge">{{ project.name }} Risk Radar&nbsp;<a class="font-xsmall link-back" href="/projects/{{ project.id }}/{{ project.name | slugify }}/">Back</a></h1>
  </div>
  <div class="example example-grid">
    <div class="grid-row">

    <div class="column-two-thirds">
      <canvas id="riskRadar" width="600" height="758" style="background-color:#ffffff">Bad times, browser doesn't support canvas. You can't see the radar.</canvas>
    </div>

    <div class="column-one-third">
      <h2 class="heading-large">Immediate</h2>
        <p>1. Someone has left the gas on and forgot about it.</p>
      <h2 class="heading-large">4 to 8 Weeks</h2>
        <p>2. 42 New people joining the project.</p>
        <p>3. Lots of Holidays this month.</p>
        <p>4. Node version goes out of LTS.</p>
      <h2 class="heading-large">8 Weeks +</h2>
        <p>5. Product Roadmap incomplete.</p>
        <p>6. Brand Relaunch.</p>

        <a class="font-xsmall" href="/projects/{{ project.id }}/{{ project.name | slugify }}/risk-radar-full-screen">full screen view</a>
    </div>

  </div>

  </div>
</main>

<script>
window.onload = function() {
  var canvas = document.getElementById('riskRadar');
  var ctx = canvas.getContext('2d');
  var height = canvas.height;
  var width = canvas.width;
  var gridDetails = buildGrid(ctx, height, width);
  gridDetails.height = height;
  gridDetails.width = width;

  //Draw Risks Section by Section
  // drawRisks(ctx, "1.1", [1],height,width,0.9);
  // drawRisks(ctx, "2.1", [2],height,width,0.9);
  // drawRisks(ctx, "2.2", [3],height,width,0.9);
  // drawRisks(ctx, "2.4", [4],height,width,0.9);
  // drawRisks(ctx, "3.3", [5,6],height,width,0.9);
}

var buildGrid = function(ctx,height,width){
  var gridDetails = {};
  gridDetails.outerRectangle = drawMaintainAspectRectangle(ctx,height,width,0.9,'#cccccc');
  gridDetails.centerRectangle = drawMaintainAspectRectangle(ctx,height,width,0.6,'#cccccc');
  gridDetails.innerRectangle = drawMaintainAspectRectangle(ctx,height,width,0.3,'#666666');

  gridDetails.crosshairs = drawCrosshairs(ctx,height,width);
  drawQuadrants(ctx, height, width, 0.8);
  return gridDetails;
}

var drawRisks = function(ctx,section, numbers, height, width, percentage){
  switch (section) {
      case "1.1":
      y = 320;
      for (var i = 0; i < numbers.length; i++) {
        drawNumber(ctx, 250, y, numbers[i]);
        y = y + 10;
      }
      case "3.3":
        y = 540;
        for (var i = 0; i < numbers.length; i++) {
          drawNumber(ctx, 90, y, numbers[i]);
          y = y + 50;
        }
      break;
    default:
  }
}

var drawNumber = function(ctx, x, y,number){
  var xOffset = x-6;
  var yOffset = y+7;

  ctx.beginPath();
  ctx.fillStyle = '#000000'
  ctx.arc(x, y, 15, 0, Math.PI * 2, true);  // Left eye
  ctx.fill();
  ctx.stroke();
  ctx.font = '24px nta, Arial, sans-serif';
  ctx.fillStyle = '#FFFFFF'
  ctx.fillText(number, xOffset, yOffset);
  ctx.closePath();
}

var drawQuadrants = function(ctx, height, width, percentage) {
  shapeWidth = width * percentage;
  shapeHeight = height * percentage;
  xPosition = (width - shapeWidth) / 2;
  yPosition = (height - shapeHeight) / 2;
  yBottomPosition = yPosition + shapeHeight;

  ctx.font = '24px nta, Arial, sans-serif';
  ctx.fillStyle = '#555555'
  ctx.fillText('Delivery', xPosition, yPosition);
  ctx.fillText('People', shapeWidth, yPosition );
  ctx.fillText('Product', xPosition, yBottomPosition);
  ctx.fillText('Technology', shapeWidth, yBottomPosition);
  ctx.closePath();
}

var drawMaintainAspectRectangle = function (ctx, height, width, percentage, color) {
  var rectangle = {};
  ctx.strokeStyle = color;
  rectangle.shapeWidth = width * percentage;
  rectangle.shapeHeight = height * percentage;
  rectangle.yPosition = (height - rectangle.shapeHeight) / 2;
  rectangle.xPosition = (width - rectangle.shapeWidth) / 2;
  ctx.strokeRect(rectangle.xPosition,rectangle.yPosition,rectangle.shapeWidth,rectangle.shapeHeight);
  return rectangle;
}

var drawCrosshairs = function(ctx, height, width){
  ctx.beginPath();
  ctx.strokeStyle = '#000000'
  var crosshairs = {
    center: width / 2,
    middle: height /2
  }

  ctx.moveTo(0, crosshairs.middle);
  ctx.lineTo(width,crosshairs.middle);

  ctx.moveTo(crosshairs.center, 0);
  ctx.lineTo(crosshairs.center,height);

  ctx.stroke();
  return crosshairs;
}
</script>
{% endblock %}
